# KN06: Kubernetes I
## A) Installation

### Subnet
![image](https://github.com/user-attachments/assets/b66e53dd-7aee-4ee3-8dc5-57a0ca71fe46)

### Network Interfaces 

![image](https://github.com/user-attachments/assets/bfaddf0f-ecb4-4586-a6f0-bf4e890beca2)

### Elastic-IP's

![image](https://github.com/user-attachments/assets/3a38f323-de12-40af-98b7-6c84511df800)

### Security-Groups 
![image](https://github.com/user-attachments/assets/a28552ac-0f54-4d11-8712-c9095e87c0fc)

### Instances 

![image](https://github.com/user-attachments/assets/b1341472-aefe-4e18-8ba9-953f2b3e79b0)

### Cloud-inti 
```yml
#cloud-config
# source: https://thenewstack.io/deploy-a-kubernetes-cluster-on-ubuntu-server-with-microk8s/
users:
  - name: ubuntu
    sudo: ALL=(ALL) NOPASSWD:ALL
    groups: users, admin, microk8s
    home: /home/ubuntu
    shell: /bin/bash
    ssh_authorized_keys:
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCUBo+qnNu5xxM9vfz4C04M36FHxHNrEMdm5TkFj1/SfVtqunlUOeMpu7nFCZZKnX8HYwf/MkjcBiTYAgncxku8grwl6XuW/pcvmb6/ghSIaw4xtRRSzit7omqJ5d8kXB3+Nd1aaMHsjfly4nkaqswhySVXQqr8Hw6DbWVw8jLLVKEE+5NZHY33hJkhJwK4blCllsGpmQaKi1qxjsN0hZOWNK01iJAydwD8t2xJ0NOYbq8Qas5IyPnRN7SPxvEhIP6WLQ6Ym6Dmf8FwNW1cHLTKabgjzt5f/HKUkKS89dPd3fn4nnFli1BOMECGUIvVlOw2pQNri7+04OOfn2FGlqr5 teacher
      - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCqCagxMF1aixN00RMl7PqpPUMyWGSZyHVDTuuN6r5WOxNa2LctWYkN/40QrU4N+4KZufbeW3w657x0+yCxXgkbOFJX/J70XQy9M6EhJCo1tstP8FgI1n0om1ZnG7pQqEV/MSZmMD6XL6lxOKUVvNzWQwkjIIKIrEdPXZiZHcC2yBfbUH3yAZhDlRp2oO62GfeIk3NV5KaaGjQVoPDBCAGUdXnw+RLHlFhPmNC0KCYHEUd78LeUnQIWzjdZZBbN+9EQTZ/MZVSa7RGN+DLJm+ZfKjnfUOBRbC1xtoRpnHOs8PYmp5F8tdiJ36+KGpZF22DRXMC3RXmkR9lEFyd3AWhH
groups:
  - microk8s
system_info:
  default_user:
    groups: [microk8s]
ssh_pwauth: false
disable_root: false
package_update: true
package_upgrade: true
packages:
  - curl
runcmd:
  - sudo snap install microk8s --classic
  - mkdir /home/ubuntu/.kube
```


### Commands for add node 
```bash
microk8s status
microk8s add-node
microk8s join <ip-address>:25000/<token>
microk8s kubectl get nodes
```

### Connection (microk8s kubectl get nodes)

![image](https://github.com/user-attachments/assets/ae7f0fe6-bd16-4cea-a2c7-ff3eba72e699)

### microk8s status

This shows if microk8s is running and if it the HA (high availability) is currently active. That means that there are multiple master nodes active and the cluster is fail-safe.

![image](https://github.com/user-attachments/assets/70e22560-21dd-4f49-b716-d69b6163cdce)


### Remove node from cluster

![image](https://github.com/user-attachments/assets/4651ca68-8ce5-4463-b19d-05aacf603b86)

![image](https://github.com/user-attachments/assets/df1ef12a-b788-4f7d-b6af-4c1e3266fc2e)

### Add node as a worker

![image](https://github.com/user-attachments/assets/46fc41ec-00f8-4a29-90e7-99141c99cbe7)

### Get nodes and status on worker node

The node that was added is a worker node instead of a control-plane. That is because the you can see that the node is not listed a "control-plane". Master nodes control the cluster, as workers only execute workloads.

![image](https://github.com/user-attachments/assets/2fd719ff-b23e-43ed-a10e-3bd0142ab468)


### Get nodes on master after added worker

![image](https://github.com/user-attachments/assets/86e72b3f-8a16-493c-8836-eb7a0cb4f012)



